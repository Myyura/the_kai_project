---
sidebar_label: "2024年8月実施 情報学基礎 F1-1"
tags:
  - Kyoto-University
  - Linear-Algebra
---
# 京都大学 情報学研究科 知能情報学専攻 2024年8月実施 情報学基礎 F1-1

## **Author**
[amongtrees](https://github.com/amongtrees), [空想性錯視](http://xhslink.com/o/6PaCtLLPAK), 祭音Myyura

## **Description**
In the questions below, $\mathbb{R}$ denotes the set of all real numbers, $\bm{a}^T$ stands for the transpose of $\bm{a}$, $\bm{A}^{-1}$ is the inverse of a matrix $ \bm{A}$, and $\bm{I}_{n}$ denotes the identity matrix of size $n \times n$.

### Q.1
Let $\bm{v} \in \mathbb{R}^{n}$ be a nonzero column vector, and define a matrix $\bm{T}$ as

$$
\bm{T} = \bm{I}_{n} - 2\frac{\bm{vv}^T}{\bm{v}^T\bm{v}}
$$

Answer the following questions.

(1) Show that $\bm{T}$ is a symmetric matrix.
(2) Show that $\bm{T}$ is an orthogonal matrix.
(3) Compute all the eigenvalues of $\bm{T}$.
(4) Compute the determinant of $\bm{T}$.
(5) Define a column vector $\bm{e}_{1} \in \mathbb{R}^{n}$ as

$$
\bm{e}_{1} = \begin{pmatrix}
1 \\
0 \\
\vdots \\
0
\end{pmatrix}
$$

Given a column vector $\bm{x} \in \mathbb{R}^n$, which is not $\bm{e}_1$ multiplied by any scalar. Determine $\bm{v}$ so that $\bm{Tx}$ becomes $\bm{e}_1$ multiplied by some scalar, and express it using $\bm{x}$ and $\bm{e}_1$.

### Q.2
Answer the following questions.
(1) Let $\bm{P}$ be an arbitrary real matrix of size $n \times n$. Assume that $\bm{I}_n + \bm{P}$ is non-singular. Show that the following equation holds.

$$
\left (\bm{I}_n + \bm{P} \right)^{-1}\bm{P} = \bm{P}\left(\bm{I}_n + \bm{P}\right)^{-1}
$$

(2) Let $\bm{Q}$ and $\bm{R}$ be arbitrary real matrices of size $n \times m$ and $m \times n$, respectively. Assume that $\bm{I}_n + \bm{QR}$ is non-singular. Show that $\bm{I}_m + \bm{RQ}$ is non-singular and that the following equation holds.

$$ \left( \bm{I}_n + \bm{QR}\right)^{-1}\bm{Q} = \bm{Q}\left(\bm{I}_m + \bm{RQ}\right)^{-1}$$

## **Kai**
### Q.1

Background: [Householder Transformation](https://en.wikipedia.org/wiki/Householder_transformation)

#### (1)

Since $\bm{I}_n$ is symmetric and $\bm{v}^T\bm{v}$ is a scalar, we have:

$$
\bm{T}^T = \left(\bm{I}_n - 2\frac{\bm{vv}^T}{\bm{v}^T\bm{v}}\right)^T = \bm{I}_n^T - 2\frac{\left(\bm{v}\bm{v}^T\right)^T}{\bm{v}^T\bm{v}} = \bm{I}_n - 2\frac{\bm{vv}^T}{\bm{v}^T\bm{v}} = \bm{T}
$$

Thus, $\bm{T}$ is a symmetric matrix.

#### (2)

According to (1), we know $\bm{T}^T = \bm{T}$, so we have:

$$
\begin{aligned}
\bm{T}^T\bm{T} = \bm{T}^2 &= \left(\bm{I}_n - 2\frac{\bm{vv}^T}{\bm{v}^T\bm{v}}\right)^2 \\
&= \bm{I}_n -4\frac{\bm{vv}^T}{\bm{v}^T\bm{v}} + 4\frac{\bm{v}\left(\bm{v}^T\bm{v}\right)\bm{v}^T}{\left(\bm{v}^T\bm{v}\right)^2} \\
&= \bm{I}_n -4\frac{\bm{vv}^T}{\bm{v}^T\bm{v}} + 4\frac{\bm{vv}^T}{\bm{v}^T\bm{v}} \\
&= \bm{I}_n
\end{aligned}
$$

Thus, $\bm{T}$ is an orthogonal matrix.

#### (3)

The form $\frac{\bm{vv}^T}{\bm{v}^T\bm{v}}$ is the [projection matrix](https://en.wikipedia.org/wiki/Projection_matrix) of vector $\bm{v}$, we can make the following classification discussion:

**Case 1: $\bm{x}$ is orthogonal to $\bm{v}$**

Let $\bm{x}$ be any non-zero vector such that $\bm{v}^T\bm{x} = \bm{0}$, obviously the subspace of satisfied vectors in $\mathbb{R}^n$ has $n-1$ demensions, and we have:

$$
\begin{aligned}
\bm{Tx} &= \left(\bm{I}_n - 2\frac{\bm{vv}^T}{\bm{v}^T\bm{v}}\right)\bm{x} \\
&= \bm{I}_n\bm{x} - 2\frac{\bm{v}\left(\bm{v}^T\bm{x}\right)}{\bm{v}^T\bm{v}} \\
&= \bm{x} - 2\frac{\bm{v}\cdot\bm{0}}{\bm{v}^T\bm{v}} \\
&= \bm{x}
\end{aligned}
$$

Thus, $\lambda = 1$ is an eigenvalue with multiplicity $n - 1$;

**Case 2: $\bm{x}$ is parallel to $\bm{v}$**

Let $\bm{x} = c\bm{v}$ for some scalar $c\neq 0$, we have:

$$
\begin{aligned}
\bm{Tx} &= \left(\bm{I}_n - 2\frac{\bm{vv}^T}{\bm{v}^T\bm{v}}\right)c\bm{v} \\
&= c\left(\bm{I}_n\bm{v} - 2\frac{\bm{v}\left(\bm{v}^T\bm{v}\right)}{\bm{v}^T\bm{v}}\right) \\
&= c\left(\bm{v} - 2\bm{v}\right) \\
&= -\bm{x}
\end{aligned}
$$

Thus, $\lambda = -1$ is an eigenvalue with multiplicity 1.

#### (4)
The determinant of a matrix is the product of its eigenvalues.

$$
det(\bm{T}) = 1^{n-1} \times (-1)^1 = -1
$$

#### (5)
We want to find a vector $\bm{v}$ such that $\bm{Tx} = k\bm{e}_1$ for some scalar $k$, where $\bm{x} \in \mathbb{R}^n$ and $\bm{x}$ is not a scalar multiple of $\bm{e}_1$.

Since $\bm{T}$ is an orthogonal matrix, it preserves the norm of the multiplied vector. Thus, $\left\|\bm{Tx}\right\| = \left\|\bm{x}\right\|$, and we have:

$$
\left\|k\bm{e}_1\right\| = \left| k \right| \cdot \left\| \bm{e}_1 \right\| = \left| k \right| = \left\|\bm{x}\right\| \Rightarrow k = \pm \left\|\bm{x}\right\|
$$

So we are actually looking for a $\bm{v}$ such that $\bm{Tx} = \pm \left\|\bm{x}\right\| \bm{e}_1$. From the definition of $\bm{T}$, we have:

$$
\bm{x} - 2\frac{\bm{v}\left(\bm{v}^T\bm{x}\right)}{\bm{v}^T\bm{v}} = \pm \left\|\bm{x}\right\| \bm{e}_1
$$

Rearranging this equation:

$$
\begin{equation}
\bm{x} \mp \left\|\bm{x}\right\| \bm{e}_1 = 2\frac{\bm{v}^T\bm{x}}{\bm{v}^T\bm{v}}\bm{v}
\end{equation}
$$

This shows that the vector $\bm{v}$ must be parallel to $\bm{x} \mp \left\|\bm{x}\right\| \bm{e}_1$. Let's choose $\bm{v}$ to be just this vector and verify the result. Let $\alpha = \pm \left\|\bm{x}\right\|$, we have $\bm{v} = \bm{x} - \alpha \bm{e}_1$. Now compute the terms in the equation (1):

$$
\begin{aligned}
\bm{v}^T\bm{v} &= \left(\bm{x} - \alpha \bm{e}_1 \right)^T\left(\bm{x} - \alpha \bm{e}_1 \right) \\
&= \bm{x}^T\bm{x} - 2\alpha \bm{x}^T\bm{e}_1 + \alpha^2\bm{e}_1^T\bm{e}_1 \\
&= \left\| \bm{x} \right\|^2 - 2\alpha x_1 + \alpha^2 \\
&= \left\| \bm{x} \right\|^2 - 2\alpha x_1 + \left\| \bm{x} \right\|^2 \\
&= 2( \left\| \bm{x} \right\|^2 - \alpha x_1 ) \\
\\
\bm{v}^T\bm{x} &= \left(\bm{x} - \alpha \bm{e}_1 \right)^T \bm{x} \\
&= \bm{x}^T\bm{x} - \alpha \bm{e}_1^T \bm{x} \\
&= \left\| \bm{x} \right\|^2 - \alpha x_1
\end{aligned}
$$

Thus, equation (1) stands true, which confirms our choice of $\bm{v}$ is correct. And the different signs influence $\bm{Tx}$ be of different scalar of $\bm{e}_1$.

### Q.2

#### (1)

$$
\begin{aligned}
(\bm{I}_n+\bm{P})\bm{P}(\bm{I}_n+\bm{P})^{-1} &= (\bm{P}+\bm{P}^2)(\bm{I}_n+\bm{P})^{-1}\\
&= \bm{P}(\bm{I}_n + \bm{P})(\bm{I}_n+\bm{P})^{-1}\\
&= \bm{P}
\end{aligned}
$$

Left-multiplying both sides of the equation by $(\bm{I}_n+\bm{P})^{-1}$, we get $\left (\bm{I}_n + \bm{P} \right)^{-1}\bm{P} = \bm{P}\left(\bm{I}_n + \bm{P}\right)^{-1}$.

#### (2)

Firstly we need prove $\bm{I}_m+\bm{RQ}$ is non-singular. Assume it's singular, then there must exist a non-zero vector $\bm{u} \in \mathbb{R}^m$ such that:
$$ (\bm{I}_m+\bm{RQ})\bm{u} = \bm{0} \Rightarrow \bm{u} = -\bm{RQu}$$
Left-multiplying by $\bm{Q}$ gives:
$$ \bm{Qu} = -\bm{QRQu} \Rightarrow (\bm{I}_n + \bm{QR})\bm{Qu} = \bm{0}$$
Since we are given that $\bm{I}_n + \bm{QR}$ is non-singular, the only solution to this equation is $\bm{Qu} = \bm{0}$. Substituting this back into the initial assumption:
$$ \bm{u} = -\bm{R\left(Qu\right)} = \bm{0}$$

This contradicts our assumption that $\bm{u}$ is a non-zero vector. Thus, $\bm{I}_m + \bm{RQ}$ must be non-singular.

Next, we have:

$$
\begin{aligned}
(\bm{I}_n + \bm{QR})\bm{Q}(\bm{I}_m + \bm{RQ})^{-1} &=(\bm{Q} + \bm{QRQ})(\bm{I}_m + \bm{RQ})^{-1} \\
&= \bm{Q}(\bm{I}_m + \bm{RQ})(\bm{I}_m + \bm{RQ})^{-1} \\
&= \bm{Q}
\end{aligned}
$$

Similarly left-multiplying both sides of the equation by $(\bm{I}_n + \bm{QR})^{-1}$, we get $ \left( \bm{I}_n + \bm{QR}\right)^{-1}\bm{Q} = \bm{Q}\left(\bm{I}_m + \bm{RQ}\right)^{-1}$.